diff --git a/Makefile.am b/Makefile.am
index c494761..c3c3534 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -1,34 +1,12 @@
 ACLOCAL_AMFLAGS = -I m4
 
-SUBDIRS=anonymizer \
-debug_sender \
-email_reporter \
-flowcounter \
-json_dump \
-json_replay \
-logger \
-logreplay \
-merger \
-report2idea \
-traffic_repeater \
-endiverter
+SUBDIRS=flowcounter \
+flow_meter \
+logreplay
 
 EXTRA_DIST = AUTHORS COPYING ChangeLog INSTALL NEWS README.md nfreader
 
-if HAVE_LIBNF
-SUBDIRS += nfreader
-else
-if HAVE_LIBNFDUMP
-SUBDIRS += nfreader
-endif
-endif
-
-if HAVE_BISON
-SUBDIRS += unirecfilter
-endif
-
 if HAVE_LIBPCAP
-SUBDIRS += flow_meter
 endif
 
 RPMDIR = RPMBUILD
diff --git a/configure.ac b/configure.ac
index f258251..ad9fffd 100644
--- a/configure.ac
+++ b/configure.ac
@@ -65,60 +65,10 @@ AC_ARG_ENABLE(repobuild, AS_HELP_STRING([--disable-repobuild],
 	*)   AC_MSG_ERROR([bad value ${enableval} for --enable-repobuild]) ;;
 esac], [repobuild=true])
 
-AX_OPENMP([], [AC_MSG_ERROR([OpenMP was not found. Some modules need it (e.g. logger and merger)])])
-AC_SUBST(OPENMP_CFLAGS)
-
 AX_LIBTRAP_CHECK
 AX_UNIREC_CHECK
 AX_NEMEACOMMON_CHECK
 
-AC_CHECK_HEADER(idna.h,
-         AC_CHECK_LIB(idn, stringprep_check_version, [libidn=yes], AC_MSG_WARN([libidn not found. The ipdetect module from blacklistfilter will not be compiled.])), AC_MSG_WARN([libidn.h not found. Blacklistfilter modules will not be compiled.]))
-
-AM_CONDITIONAL(HAVE_LIBIDN, test x${libidn} = xyes)
-if [[ -z "$HAVE_LIBIDN_TRUE" ]]; then
-RPM_REQUIRES+=" libidn"
-RPM_BUILDREQ+=" libidn-devel"
-fi
-
-AC_ARG_WITH([nfreader],
-	AC_HELP_STRING([--without-nfreader], [Skip nfreader module.]),
-        [if test "$withval" = "no"; then
-                withnfreader="no"
-        else
-                withnfreader="yes"
-        fi], [withnfreader="yes"])
-
-if test x${withnfreader} = xyes; then
-	# Checks for libraries.
-	AC_CHECK_LIB(nf, lnf_open, [libnf=yes],
-	  [AC_CHECK_LIB(nfdump, nfdump_init, [libnfdump=yes],
-	    [AC_MSG_WARN([libnf and libnfdump not found. The nfreader module will not be compiled.])]
-	  )]
-	)
-
-fi
-AM_CONDITIONAL(HAVE_LIBNFDUMP, test x${libnfdump} = xyes && test x${withnfreader} = xyes)
-if [[ -z "$HAVE_LIBNFDUMP_TRUE" ]]; then
-RPM_REQUIRES+=" libnfdump"
-RPM_BUILDREQ+=" libnfdump-devel"
-fi
-
-AM_CONDITIONAL(HAVE_LIBNF, test x${libnf} = xyes && test x${withnfreader} = xyes)
-if [[ -z "$HAVE_LIBNF_TRUE" ]]; then
-RPM_REQUIRES+=" libnf"
-RPM_BUILDREQ+=" libnf-devel"
-fi
-
-AC_CHECK_PROG(BISON, bison, yes, [""])
-AC_CHECK_PROG(FLEX, flex, yes, [""])
-
-AM_CONDITIONAL(HAVE_BISON, test xyes = x${BISON} -a xyes = x${FLEX})
-if [[ -z "$HAVE_BISON_TRUE" ]]; then
-RPM_BUILDREQ+=" bison"
-RPM_BUILDREQ+=" flex"
-fi
-
 AC_CHECK_HEADER(pcap.h,
         AC_CHECK_LIB(pcap, pcap_open_live, [libpcap=yes], AC_MSG_WARN([libpcap not found. The flow_meter module will not be compiled.])), AC_MSG_WARN([pcap.h not found. The flow_meter module will not be compiled.]))
 
@@ -129,7 +79,7 @@ RPM_BUILDREQ+=" libpcap-devel"
 fi
 
 # Checks for header files.
-AC_CHECK_HEADERS([arpa/inet.h locale.h netdb.h netinet/in.h stddef.h stdint.h stdlib.h string.h sys/socket.h sys/time.h syslog.h unistd.h omp.h])
+AC_CHECK_HEADERS([arpa/inet.h locale.h netdb.h netinet/in.h stddef.h stdint.h stdlib.h string.h sys/socket.h sys/time.h syslog.h unistd.h])
 
 # Checks for typedefs, structures, and compiler characteristics.
 AC_HEADER_STDBOOL
@@ -151,10 +101,8 @@ AC_FUNC_FORK
 AC_FUNC_MALLOC
 AC_FUNC_REALLOC
 AC_FUNC_STRTOD
-AC_CHECK_FUNCS([alarm clock_gettime floor gettimeofday localeconv memset mkdir pow setlocale sqrt strchr strdup strerror strstr strtol strtoul])
+AC_CHECK_FUNCS([alarm clock_gettime floor gettimeofday localeconv memset mkdir pow sqrt strchr strdup strerror strstr strtol strtoul])
 
-# Check for sigaction
-AC_CHECK_FUNC(sigaction, AC_DEFINE(HAVE_SIGACTION, 1, [Define if you have the 'sigaction' function]))
 
 #RPM & Doxygen
 AC_SUBST(RPMBUILD)
@@ -170,22 +118,9 @@ AM_CONDITIONAL(MAKE_RPMS, test x$RPMBUILD != x)
 
 # list of all *.in (and Makefile.am) files to process by configure script
 AC_CONFIG_FILES([Makefile
-                 anonymizer/Makefile
-                 debug_sender/Makefile
-                 email_reporter/Makefile
                  flowcounter/Makefile
                  flow_meter/Makefile
-                 json_dump/Makefile
-                 json_replay/Makefile
-                 logger/Makefile
                  logreplay/Makefile
-                 merger/Makefile
-                 nemea-modules.spec
-                 nfreader/Makefile
-                 report2idea/Makefile
-                 traffic_repeater/Makefile
-                 unirecfilter/Makefile
-                 endiverter/Makefile
                ])
 
 AC_SUBST(RPM_REQUIRES)
diff --git a/flow_meter/sipplugin.cpp b/flow_meter/sipplugin.cpp
index 978a657..506db11 100644
--- a/flow_meter/sipplugin.cpp
+++ b/flow_meter/sipplugin.cpp
@@ -265,7 +265,7 @@ const unsigned char * SIPPlugin::parser_strtok(const unsigned char *str, unsigne
 #define FOUND(A)        { nst->saveptr = cp + (A) + 1; *strlen = len + A; nst->instrlen -= A + 1; return beginning; }
 
    /* Go across the string word by word: */
-   longword_ptr = (unsigned long int *)char_ptr;
+   longword_ptr = (MAGIC_INT *)char_ptr;
    for (;;) {
       /*
        * Get the current item and move to the next one. The XOR operator does the following thing:
